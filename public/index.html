<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="dns-prefetch" href="//ajax.googleapis.com" />
	<title>MAC PAN</title>
</head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="assets/application.js"></script>
<link href="assets/screen.css" rel="stylesheet" media="screen" />
<body>
  <ul id='messages'></ul>
	<div id="board">
	  <div class="pellet" data-x="0" data-y="0" data-visible="true"></div>
    <div class="pellet" data-x="1" data-y="0" data-visible="true"></div>
    <div class="pellet" data-x="2" data-y="0" data-visible="false"></div>
    <div class="pellet" data-x="3" data-y="0" data-visible="true"></div>

	  <div class="pellet" data-x="0" data-y="1" data-visible="true"></div>
    <div class="pellet" data-x="1" data-y="1" data-visible="true"></div>
    <div class="pellet" data-x="2" data-y="1" data-visible="false"></div>
    <div class="pellet" data-x="3" data-y="1" data-visible="true"></div>

	  <div class="pellet" data-x="0" data-y="2" data-visible="true"></div>
    <div class="pellet" data-x="1" data-y="2" data-visible="true"></div>
    <div class="pellet" data-x="2" data-y="2" data-visible="false"></div>
    <div class="pellet" data-x="3" data-y="2" data-visible="true"></div>

	  <div class="pellet" data-x="0" data-y="3" data-visible="true"></div>
    <div class="pellet" data-x="1" data-y="3" data-visible="true"></div>
    <div class="pellet" data-x="2" data-y="3" data-visible="true"></div>
    <div class="pellet" data-x="3" data-y="3" data-visible="false"></div>

	  <div class="pellet" data-x="0" data-y="4" data-visible="false"></div>
    <div class="pellet" data-x="1" data-y="4" data-visible="true"></div>
    <div class="pellet" data-x="2" data-y="4" data-visible="true"></div>
    <div class="pellet" data-x="3" data-y="4" data-visible="true"></div>
    
    <svg version="1.1" id="pinky" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    	 width="35.999px" height="43.5px" viewBox="302 458 35.999 43.5" enable-background="new 302 458 35.999 43.5"
    	 xml:space="preserve">
    <path fill="#FF4C3F" d="M329.668,458h-18.001L302,465.5v18l1.084,18l8.791-9l8.896,9l8.613-9l8.614,9v-36L329.668,458z
    	 M314.667,472.1c-1.988,0-3.6-1.611-3.6-3.6s1.61-3.6,3.6-3.6s3.6,1.611,3.6,3.6S316.655,472.1,314.667,472.1z M326.667,472.1
    	c-1.988,0-3.6-1.611-3.6-3.6s1.61-3.6,3.6-3.6s3.601,1.611,3.601,3.6S328.655,472.1,326.667,472.1z"/>
    </svg>
    <script>
      $(document).ready(function(){

        var i = 0;
        $('.pellet').each(function(){
          if($(this).data('visible')){
            var x = $(this).data('x') * 20;
            var y = $(this).data('y') * 20;
          $(this).css({left:x, top:y})
        }else{
          $(this).hide();
        }

        });

        ws = new WebSocket("ws://localhost:8888");
        ws.onmessage = function(evt) {
          $("ul#messages").prepend("<li>RESPONSE: "+evt.data+"</li>");
          $("#pinky").
        };
        ws.onclose = function() { echo("socket closed"); };
        ws.onopen = function() {
          echo("connected...");
        };

        function echo(str){ 
          var obj = {
            'move': str,
            "character": 'pinky'
          };
          obj = JSON.stringify(obj);
          ws.send(obj);
          $("ul#messages").prepend("<li>SENT: "+str+"</li>");
          if(str=="down"){ // This is just a placeholder;
            // we'll need the server to send us dead pellet coordinates,
            // presumably, something like "kill(0,1)"
            // to tell us which pellet to .hide()
            var deadPellet = $('.pellet[data-x="0"][data-y="1"]');
            deadPellet.css("background","red")
          }
        };

        $(document).keydown(function(e) {
          switch(e.keyCode) { 
           case 38:
            echo('up');
            break;
           case 40:
             echo('down');
             break;
           case 39:
             echo("right");
             break;
           case 37:
             echo("left");
             break;
          }
        });
      });
    </script>
	  
  </div>
</body>
</html>
